RewriteEngine On

# Handle all requests through index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# Security - Deny access to PHP files in uploads directory
<FilesMatch "\.(php|php3|php4|php5|phtml)$">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_URI} ^.*/uploads/.*$
        RewriteRule ^.*$ - [F,L]
    </IfModule>
</FilesMatch>